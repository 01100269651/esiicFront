

<div style="overflow-y: auto; height:700px ;">

<div class="col m-1 " >
  <div class="card-header text-center">  
      <button styleSheetFile="assets/css/custom1.css"  class="btn-sm btn-primary  " printSectionId="print-section" ngxPrint>
         <mat-icon>print</mat-icon>طباعة</button>
   
  </div>
    <div class="card mb-4" id="print-section">
     
      <table class="mt-1 me-3" id="xyz" style=" border: 0px solid white;">
        <tr style="direction: rtl; border: 0px solid white;">
          <th class="fs-3 fw-bolder text-dark display-4" style="direction: rtl; border: 0px solid white; text-align: right;" colspan="5">
            شركة السكر و الصناعات التكاملية المصرية
        
        </th>
        <th></th>
        <th>  تاريخ الطباعة:{{cdate | date : "yyyy/MM/dd hh:mm"}}</th>
  
      </tr>
      <tbody style="border: 0px solid white;">
     
        <tr  style="border: 0px solid white;">
          <td class="fs-4 text-dark fw-bolder" style="width: 50px;">مصنـــع</td>
          <td class="fs-4 text-dark fw-bolder" style="width: 50px;"> {{   factId}}</td>
          <td class="fs-4 text-dark fw-bolder" style="width: 50px;">{{   fact}}</td>
          <td></td>
          <td rowspan="2" class="fs-1 display-1 text-dark fw-bolder" style="text-decoration: underline; font-size: 36px;text-align: right; padding-right:150px;"> {{typeName}}
  
          </td>
          <td></td>
          <td></td>
        </tr>
        <tr  style="border: 0px solid white;">
          <td class="fs-5 text-dark fw-bolder"  colspan="2">القســـم الطالب:</td>
          <td class="fs-4 text-dark fw-bolder" colspan="2">{{dept}}</td>
         
          <td></td>
          <td></td>
          <td></td>
        </tr>
        
        <tr  style="border: 0px solid white;">
  
          <td class="fs-5 text-dark   fw-bold" colspan="2">رقم الطلب م.م.:</td>
  
          <td class="fs-4 text-dark fw-bolder">{{ordId}}</td>
  
          <td class="fs-4 text-dark fw-bolder">{{this.ordDate  | date : "yyyy/MM/dd "}}</td>
  
          <td  >                 </td>
  
          <td class="fs-4 text-dark  fw-bold" style="padding-left:1px ;"><span class="fs-4 text-dark  fw-bold">رقم مشتريات:{{this.fnlId}}</span></td> 
          
          <td  style="padding-right: 1px;"><span class="fs-4 text-dark  fw-bold">تاريخ: {{this.fnlDate|date : "yyyy/MM/dd"}}</span></td> 
  
        </tr>
      </tbody>
      </table>
   
     
      <div class="card-body"  >
          
  
          <div class="card" mat-card style="height:600px;" >
              <!-- <h3 class="card-header">
             
              </h3> -->
              <div class="card-body mat-elevation-z20 " >
           
             <div style=" overflow-x: scroll;
             overflow-y: hidden;" >
                <mat-form-field class="hi">
                  <mat-label>بحث</mat-label>
                  <input matInput (keyup)="applyFilter($event)" placeholder="ابحث رقم صنف" #input>
                </mat-form-field>
                <table class="text-dark mt-1 fs-5 fw-bolder bg-info mt-4"  mat-table [dataSource]="dataSource"  >
      
                  <ng-container matColumnDef="position">
                    <th mat-header-cell *matHeaderCellDef >م</th>
                    <td mat-cell *matCellDef="let element; let i = index">{{i + 1}}</td>
                   
                  </ng-container>
          
                  <ng-container matColumnDef="item_No">
                    <th mat-header-cell *matHeaderCellDef>رقم الصنف</th>
                    <td mat-cell *matCellDef="let element">{{element.item_No ?? ''}}</td>
                 
                  </ng-container>
                  <ng-container matColumnDef="tech_Descr">
                    <th mat-header-cell *matHeaderCellDef>مواصفات فنية</th>
                    <td mat-cell *matCellDef="let element">{{element.tech_Descr ?? ''}}</td>
                  </ng-container>
                  
  
                  <ng-container matColumnDef="item_Name">
  
                    <th  mat-header-cell *matHeaderCellDef > الصنف </th>
  
                    <td  mat-cell *matCellDef="let element " NOWRAP>  {{element.item_Name ??''}} </td>
  
                  </ng-container>
                  <!-- scM_Item.scM_Unit.name -->
                  <ng-container matColumnDef="unit_Name">
  
                    <th  mat-header-cell *matHeaderCellDef >الوحدة</th>
  
                    <td  mat-cell *matCellDef="let element " >  {{element.unit_Name??''}} </td>
  
                  </ng-container>
          
                  <ng-container matColumnDef="quantity">
  
                    <th  mat-header-cell *matHeaderCellDef > الكمية </th>
  
                    <td  mat-cell *matCellDef="let element "   > 
                       <input style="width:90px;" class="form-control text-danger display-1 fs-5 fw-bolder" [readOnly]="signFlag" #qty value="{{element.quantity??'0'}}"
                       
                       (change)="updateQty(element.fact_Id,element.type,element.season,element.ordId,element.item_No ,qty.value)" (click)="check()"> </td>
  
                    <tfoot mat-footer-cell *matfootercelldef>     total hours: {{ total }}                </tfoot>
  
                  </ng-container>
  
      
                  <ng-container matColumnDef="balance">
  
                    <th  mat-header-cell *matHeaderCellDef >الرصيد</th>
  
                    <td  mat-cell *matCellDef="let element " >  {{element.balance??'0'}} </td>
  
                  </ng-container>

                  <ng-container matColumnDef="cons1">
  
                    <th  mat-header-cell *matHeaderCellDef >{{ses-1}}</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.cons1??'0'}} </td>
                  </ng-container>
               

            
                 
      
                  <ng-container matColumnDef="cons2">
                    <th  mat-header-cell *matHeaderCellDef >{{ses-2}}</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.cons2??'0'}} </td>
                  </ng-container>


                  <ng-container matColumnDef="cons3">
                    <th  mat-header-cell *matHeaderCellDef >{{ses-3}}</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.cons3??'0'}} </td>
                  </ng-container>
      
              
      
                  <ng-container >
                    <th  mat-header-cell *matHeaderCellDef >المعدل</th>
                    <td  mat-cell *matCellDef="let element " >  {{(element.cons3 +element.cons2+element.cons1) / 3}} </td>
                  </ng-container>
          
                  <ng-container matColumnDef="incomeJuly">
                    <th  mat-header-cell *matHeaderCellDef >7/1</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.incomeJuly??'0'}} </td>
                  </ng-container>
      
                  <ng-container matColumnDef="old_Rec_Id">
                    <th  mat-header-cell *matHeaderCellDef >ع أ</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.old_Rec_Id??'0'}} </td>
                  </ng-container>
      
                  <ng-container matColumnDef="old_Rec_Date">
                    <th  mat-header-cell *matHeaderCellDef >تاريخ ع أ</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.old_Rec_Date | date : "yyyy/MM/dd"}} </td>
                  </ng-container>
          
                  <ng-container matColumnDef="old_Price">
                    <th  mat-header-cell *matHeaderCellDef >السعر</th>
                    <td  mat-cell *matCellDef="let element " >  {{element.old_Price }} </td>
                  </ng-container>
      
                  <ng-container matColumnDef="old_Sup_Id">
                    <th   mat-header-cell *matHeaderCellDef >المورد</th>
                    <td  mat-cell *matCellDef="let element " NOWRAP >  {{element.old_Sup_Id ?? 0}} </td>
                   
                  </ng-container>

                  <ng-container   matColumnDef="show_Id">
       
                    <th mat-header-cell *matHeaderCellDef></th>
                 
                    <td mat-cell *matCellDef="let row">
                 
                      <button mat-button *ngIf="app_Id" (click)="addShow(row.fact_Id,row.season,row.type,row.ord_Id,row.item_No)" class=" btn btn-outline-primary mat-elevation-z5 display-1 fs-5 fw-bolder ">عرض سعر</button>
                 
                    </td>
                  </ng-container>

                  
               
          
          
                  <tr mat-header-row class="text-dark display-1 fs-5 fw-bolder bg-secondary  mt-4" *matHeaderRowDef="displayedColumns"></tr>
        
                  <tr class="text-dark display-1 fs-5 fw-bolder table-row "  mat-row  *matRowDef="let row; columns: displayedColumns;" ></tr>
           
            <tr>

            </tr>
               
                </table>
                <mat-paginator #paginator class="hi" [pageSizeOptions]="[5, 10, 20,40]" matSort 
                showFirstLastButtons      aria-label="Select page of periodic elements">
              </mat-paginator>
              </div>
                <br>
                <div style="font-style: normal;font-weight: bolder; font-size: 26px;" style="direction: rtl;">
                  <label style="font-style: normal;font-weight: bolder; font-size: 20px;margin: 2px;">سبب الأستعمال:</label>
                  <LABEL>{{cause}}</LABEL>
                </div>
                <table class="fs-5 text-dark fw-bold" style="width:100%;border: 1px solid white;margin:3px ;text-align: center; " id="signtable">
                  <tr>
                  
                    <td>مراقبة المخزون</td>
  
                    <td> المخزن العام</td>
                    <td colspan="2"> حسابات المخازن</td>
                
  
                  </tr>
                  <tr >
                    <td><div *ngIf="signIc ===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>
                      <div *ngIf="signIc ===0"  small class="text-danger fs-5">تم الرفض رقميا</div>
                      <div *ngIf="signIc ===null"  small class="text-primary fs-5">------</div>
                    </td>
                    <td>
                       <div *ngIf="signStocks ===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>
                      <div *ngIf="signStocks ===0"  small class="text-danger fs-5">تم الرفض رقميا</div>
                      <div *ngIf="signStocks === null"  small class="text-primary fs-5">------</div>
                    </td>
                    <td colspan="2">
                      <div *ngIf="signStockCal ===1 "  small class="text-primary fs-5">تم الاعتماد رقميا</div>
                      <div *ngIf="signStockCal ===0"  small class="text-danger fs-5">تم الرفض رقميا</div>
                      <div *ngIf="signStockCal ===null"  small class="text-primary fs-5">------</div>


                    </td>
                    <td></td>
                  
                  </tr>
                  <tr>
                    <td>مدير عام الإدارة الهندسية</td>
                    <td>مدير عام المراجعة  </td>
                    <td>مدير عام الإدارة المالية</td>
                   
                    <td >نائب رئيس قطاعات المصانع</td>
                   
                      <td style="font-size: 20px; font-weight: bolder;text-decoration: double;">رئيس قطاعات المصانع</td>
                   
                  </tr>
                  <tr>
                 
                    <td>
                      <div *ngIf="signEngMan ===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>

                      <div *ngIf="signEngMan === 0"  small class="text-danger fs-5">تم الرفض رقميا</div>

                      <div *ngIf="signEngMan === null"  small class="text-primary fs-5">----------</div>

                    



                    </td>
                    <td>
                      <div *ngIf="signReview ===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>

                      <div *ngIf="signReview === 0"  small class="text-danger fs-5">تم الرفض رقميا</div>

                      <div *ngIf="signReview === null"  small class="text-primary fs-5">----------</div>

                    



                    </td>
                    <td>
                      <div *ngIf="signFin ===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>
                      <div *ngIf="signFin ===0"  small class="text-primary fs-5">تم الرفض رقميا</div>
                      <div *ngIf="signFin ===null"  small class="text-primary fs-5">------</div>



                    </td>
                    <td>
                      <div *ngIf="signViceCEOFact ===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>
                      <div *ngIf="signViceCEOFact ===0"  small class="text-danger fs-5">تم الرفض رقميا</div>
                      <div *ngIf="signViceCEOFact === null"  small class="text-primary fs-5">------</div>



                    </td>
                    <td>
                      <div *ngIf="signCEOFact===1"  small class="text-primary fs-5">تم الاعتماد رقميا</div>
                      <div *ngIf="signCEOFact===0"  small class="text-danger fs-5">تم الرفض رقميا</div>
                      <div *ngIf="signCEOFact ===null"  small class="text-primary fs-5">------</div>



                    </td>
                  
                  </tr>
                </table>
             
  
              </div>
           </div>
          
  
           
      
  
          
      </div>
      
    </div>
    
    <!-- <div class="card-footer text-center">    <button styleSheetFile="assets/css/custom1.css"  class="btn btn-primary  " printSectionId="print-section" ngxPrint> <mat-icon>print</mat-icon>طباعة</button>
        
    </div> -->
  
  </div>
</div>
  
  <!-- [printStyle]="{h1 : {'color': 'red'}, h2 : {'border': 'solid 1px'}}"
   -->